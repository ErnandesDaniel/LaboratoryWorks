
Данные установленного GitLab находятся в директории, соответствующей переменной окружения GITLAB_HOME
в нашем примере в /root/docker-compose-gitlab-volumes

Для создания бэкапа данных GitLab необходимо, чтобы он был запущен через docker-compose up, если он все еще не запущен

Имя контейнера как указано в файле конфигурации - gitlab

Для создания бэкапа нужно выполнить команду docker exec -t gitlab gitlab-backup create

Выполнение команды займет около минуты, после этого будет выполнен бэкап

Она обратится к контейнеру gitlab и выполнит соответствующую команду для создания бэкапа

В папке /root/docker-compose-gitlab-volumes есть папка data, а в ней backups, где будут находится файлы бэкапа

Таким образом бэкапы будут находится в директории
/root/docker-compose-gitlab-volumes/data/backups или иначе $GITLAB_HOME/data/backups

Переходить в эту папку можно через команду cd $GITLAB_HOME/data/backups

Далее необходимо скопировать файлы конфигурации с секретными данными

$GITLAB_HOME/config/gitlab.rb

$GITLAB_HOME/config/gitlab-secrets.json

Для восстановления данных из бэкапа необходимо создать папки $GITLAB_HOME/data/backups, $GITLAB_HOME/config/;
Сохраненные файлы поместить в свои папки

Запустить gitlab через команду docker-compose up -d

Подождать времени начала работы приложения (примерно 3 минуты)

Чтобы восстановить данные из бэкапа нужно выполнить команду docker exec -it gitlab gitlab-backup restore